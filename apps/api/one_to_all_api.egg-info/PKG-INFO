Metadata-Version: 2.4
Name: one_to_all_api
Version: 0.1.0
Summary: FastAPI backend for One-to-All-app.
Requires-Python: <3.13,>=3.12
Description-Content-Type: text/markdown
Requires-Dist: fastapi>=0.115.0
Requires-Dist: uvicorn[standard]>=0.30.0
Requires-Dist: celery>=5.4.0
Requires-Dist: redis>=5.0.0
Requires-Dist: python-multipart>=0.0.9
Requires-Dist: pip>=24.0
Requires-Dist: py_core
Provides-Extra: dev
Requires-Dist: httpx>=0.27.0; extra == "dev"
Requires-Dist: pytest>=8.0.0; extra == "dev"
Provides-Extra: model-download
Requires-Dist: modelscope>=1.18.0; extra == "model-download"

# one_to_all_api

## Dev run

1. Start dependencies (Redis + Postgres)
   - `docker compose -f infra/docker-compose.dev.yml up -d redis postgres`

2. Install deps
   - `uv sync --project apps/api`

3. Run API
   - `uv run --project apps/api uvicorn main:app --reload --host 0.0.0.0 --port 8000`

## Use pip (inside project venv)

- `uv run --project apps/api pip list`
- `uv run --project apps/api python -m pip list`

## Create a job

- `POST /jobs/one-to-all` with JSON body:
  - `reference_image`: local path or S3 key/URL
  - `motion_video`: local path or S3 key/URL
  - `output_s3_key` (optional): if set and S3 configured, worker uploads result there

## Env

Copy `env.example` to `.env` (do not commit `.env`).

## Download checkpoints (ModelScope)

- Install optional deps: `uv sync --project apps/api --extra model_download`
- Download (skips if already present): `uv run --project apps/api scripts/download_modelscope_one_to_all.py --model 14b`
