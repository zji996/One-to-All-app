# Celery / Redis
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_DEFAULT_QUEUE=one_to_all

# Postgres (job history)
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/one_to_all

# Runtime directories (local dev only; data/ is temporary)
DATA_DIR=data
MODELS_DIR=models
ONE_TO_ALL_MODEL_DIR=One-to-All-14b-FP8
ONE_TO_ALL_MODEL_REPO_ID=MochunniaN1/One-to-All-14b

# Inference quality / memory trade-offs (applies to One-to-All-Animation wrapper)
# Resize policy: default `max_short=576` (upstream default). Lower values save VRAM but reduce quality.
# ONE_TO_ALL_MAX_SHORT=576
# Optional long-side cap (if unset, <=36GB GPUs default to 1024 to avoid OOM on extreme aspect ratios).
# ONE_TO_ALL_MAX_LONG=1024
# Chunking: leave unset to auto-tune by VRAM (<=36GB -> 33, else -> 81).
# ONE_TO_ALL_MAIN_CHUNK=
# Overlap between chunks; leave unset to use defaults derived from `ONE_TO_ALL_MAIN_CHUNK`.
# ONE_TO_ALL_OVERLAP_FRAMES=
# Debug only (speeds up A/B checks but degrades results):
# ONE_TO_ALL_DEBUG_MAX_FRAMES=
# ONE_TO_ALL_DEBUG_MAX_CHUNKS=

# Optional: enable DF11 loading when the model repo contains `transformer_df11/` (and/or `text_encoder_df11/`).
# Requires `dfloat11` + CUDA (see `apps/worker/pyproject.toml` extra `df11`).
ONE_TO_ALL_USE_DF11=0
# Prefer DF11's block-level offload (DF11 tensors stay on CPU and are copied per-layer) instead of diffusers CPU offload.
ONE_TO_ALL_DF11_PREFER_BLOCK_OFFLOAD=1
ONE_TO_ALL_DF11_CPU_OFFLOAD=1
ONE_TO_ALL_DF11_PIN_MEMORY=1
# DF11 offload scope:
# - unset/empty: offload all blocks (recommended)
# - 0: offload none (keeps DF11 tensors on GPU; higher VRAM)
# - N>0: offload first N blocks
# ONE_TO_ALL_DF11_CPU_OFFLOAD_BLOCKS=
# Also load `text_encoder_df11/` when available.
ONE_TO_ALL_DF11_TEXT_ENCODER=1
# Precompute prompt embeds once and drop text encoder after (saves VRAM and avoids repeated T5 per chunk).
ONE_TO_ALL_PRECOMPUTE_PROMPT_EMBEDS=1
ONE_TO_ALL_DROP_TEXT_ENCODER_AFTER_PROMPT=1

# Pose preprocessing (ONNXRuntime)
ONE_TO_ALL_POSE_USE_ONNX=1
ONE_TO_ALL_ONNX_SAVE_OPTIMIZED=1

# One-to-All pretrained assets (Wan base model + pose preprocess checkpoints)
ONE_TO_ALL_PRETRAINED_DIR=models/One-to-All-14b-FP8/pretrained_models
WAN_T2V_14B_DIFFUSERS_DIR=models/One-to-All-14b-FP8/pretrained_models/Wan2.1-T2V-14B-Diffusers

# Optional S3/MinIO (recommended for persistent artifacts)
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET_NAME=one-to-all
S3_REGION=us-east-1
S3_SECURE=false
S3_PREFIX=one-to-all

# One-to-All-Animation runtime (keeps `third_party/` read-only; should contain only caches/workdirs, no model copies)
ONE_TO_ALL_RUNTIME_DIR=data/one_to_all_animation_runtime
